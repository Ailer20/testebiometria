<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autenticação Biométrica</title>
</head>
<body>
    <h1>Autenticação Biométrica</h1>
    <button id="biometricButton">Registrar Presença</button>

    <script>
        // Função para verificar se o dispositivo suporta a WebAuthn
        async function verificarBiometria() {
            if (window.PublicKeyCredential) {
                console.log("Suporte a WebAuthn detectado!");

                try {
                    // Tenta obter credenciais existentes (caso já tenha feito um login com biometria antes)
                    const credential = await navigator.credentials.get({ 
                        publicKey: {
                            challenge: new Uint8Array([0x00, 0x01, 0x02, 0x03]), // Geração de desafio aleatório
                            timeout: 60000, // Timeout de 1 minuto
                            userVerification: "required" // Verificação obrigatória do usuário (biometria)
                        }
                    });

                    // Caso tenha sucesso
                    if (credential) {
                        console.log("Autenticação biométrica bem-sucedida!");
                        alert("Você foi autenticado com sucesso!");
                    }
                } catch (error) {
                    console.log("Erro ao autenticar biometria:", error);
                    alert("Falha na autenticação biométrica.");
                }

            } else {
                console.log("WebAuthn não é suportado nesse navegador.");
                alert("Este navegador não suporta biometria.");
            }
        }

        // Função de click do botão para registrar presença
        document.getElementById("biometricButton").addEventListener("click", async () => {
            console.log("Iniciando autenticação biométrica...");

            // Verifica e tenta realizar a autenticação biométrica
            await verificarBiometria();
        });
    </script>
</body>
</html>
